<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="mapper.UserMapper">

<!-- 회원가입 -->
<insert id="insertMethod" parameterType="dto.UserDTO">
insert into member(mem_id,mem_pwd,mem_email,mem_ip,mem_grade,mem_uuid) values(#{mem_id,jdbcType=VARCHAR},#{mem_pwd,jdbcType=VARCHAR},#{mem_email,jdbcType=VARCHAR},#{mem_ip,jdbcType=VARCHAR},0,#{mem_uuid,jdbcType=VARCHAR})
</insert>

<!-- 이메일인증위한 mem_uuid grade확인 -->
<select id="FindEmailMethod" parameterType="string" resultType="dto.UserDTO">
select mem_uuid,mem_grade from member where mem_email=#{mem_email}
</select>
<!-- 이메일 인증  -->
<update id="UpdateGrade" parameterType="string">
update member set mem_grade=1 where mem_uuid=#{mem_uuid}
</update>

<!-- 비밀번호변경  -->
<update id="UpdatePwd" parameterType="dto.UserDTO">
update member set mem_pwd=#{mem_pwd} where mem_uuid=#{mem_uuid}
</update>
<!-- mem_uuid 새로운거로 변경 -->
<update id="Updateuuid" parameterType="dto.UserDTO">
update member set mem_uuid=#{mem_newuuid} where mem_uuid=#{mem_uuid}
</update>

<!--로그인  -->

<select id="Select_id" parameterType="dto.UserDTO" resultType="dto.UserDTO">
select * from member where mem_id=#{mem_id} and mem_pwd=#{mem_pwd} 
</select>

<!-- 아이디 중복검사  -->
<select id="Test_id" parameterType="dto.UserDTO" resultType="int">
select count(*) from member where mem_id=#{mem_id}
</select>
<!-- ip 검사 -->
<select id="Select_ip" parameterType="String" resultType="String">
select mem_ip from member where mem_id=#{mem_id}
</select>
<!-- ip update -->
<update id="Update_ip" parameterType="dto.UserDTO">
update member set mem_ip=concat(mem_ip,#{mem_ip}) where mem_id=#{mem_id}
</update>

<!-- email 중복검사 -->
<select id="Test_email" parameterType="dto.UserDTO" resultType="int">
select count(*) from member where mem_email=#{mem_email}
</select>
<!-- google 회원가입 -->
<insert id="insert_google" parameterType="dto.UserDTO">
insert into member(mem_id,mem_email,mem_name) values (#{mem_id},#{mem_email},#{mem_name})
</insert>

</mapper>